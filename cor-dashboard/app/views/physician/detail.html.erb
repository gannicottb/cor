<% values = {} %>
<div class="col col-lg-2">
  <div class="row" style="padding-left: 10px;">

    <div>
      <button><div id="slidehorizontal"><%= image_tag "hamburger.png" %></div></button> <br>
    </div>
    <div class="col col-sm-2" id="navvertical">
      <ul>
        <br>
        <li><%= button_to "Weight", patient_weight_path, :remote => true, class:"btn btn-default w75", method: "get", id: "weight" %></li><br>
        <li><%= button_to "Blood Pressure", patient_blood_pressure_path, :remote => true, class:"btn btn-default w75", method: "get", id: "bloodpress" %></li><br>
        <li><%= link_to "Heart Rate", patient_heart_rate_trend_path, :remote => true, class:"btn btn-default w75", method: "get", id:"heartratetrend" %></li><br>
        <li><%= link_to "Blood Oxygen", patient_blood_oxygen_path, :remote => true, class:"btn btn-default w75", method: "get", id:"bloodoxygen" %></li><br>
        <li><%= link_to "Activity", patient_activity_log_path, :remote => true, class:"btn btn-default w75", method: "get", id:"activity" %></li><br>
        <li><%= link_to "Sodium", patient_sodium_path, :remote => true, class:"btn btn-default w75", method: "get", id:"sodium" %></li><br>
        <!--li><button>Sodium Intake</button></li-->
      </ul>
    </div>
  <ul>
  <li>
  <div class="col col-md-2" id="patientpic-container">
    <img src="http://placehold.it/200x220"></img>
  </div>
  </li>
    <li> <div class="col col-md-2" id="patientinfo-container"></div>  </li> <br>
    <li><div class="col col-md-2" id="medication-container"></div>   </li>
   </ul>
    </div>
</div>
<div class="col col-md-10">
  <br>
  <div class="col col-md-12" id="graph-container" align="center">
    <div class="btn-group" id="timeperiod">
      <button type="button" class="btn btn-default" id="oneweek">Last Week </button>
      <button type="button" class="btn btn-default" id="twoweeks">Last two Weeks </button>
      <button type="button" class="btn btn-default" id="onemonth"> Last one month</button>
      <button type="button" class="btn btn-default" id="threemonths">Last three months</button>
      <button type="button" class="btn btn-default" id="sixmonths">Last six months</button>
      <button type="button" class="btn btn-default" id="ayear">Last year</button>
    </div>
    <div id="chart" style="padding-top: 10px;"></div>
  </div>
  <div class="col col-md-12" id="metrictable-container">
    <table class="table" id="weight_tab">
      <thead>
        <tr>
          <th>Reading Time</th>
          <th>Weight</th>
        </tr>
      </thead>
      <tbody>
        <% values.each do |i| %>
        <tr>
          <% sec = (i[0].to_f / 1000) %>
          <% datetime = Time.at(sec) %>
          <th><%=datetime%></th>
          <th><%= i[1] %></th>
        </tr>
        <% end %>
      </tbody>
    </table>
    <table class="table" id="bloodpressure_tab">
      <thead>
      <tr>
        <th>Reading Time</th>
        <th>Systolic</th>
        <th>Diastolic</th>
      </tr>
      </thead>
      <tbody>
      <% @values_bp.each do |i| %>
          <tr>
            <% sec = (i[0].to_f / 1000) %>
            <% datetime = Time.at(sec) %>
            <th><%=datetime%></th>
            <th><%= i[1] %></th>
            <th><%= i[2] %></th>
          </tr>
      <% end %>
      </tbody>
    </table>
    <table class="table" id="heartrate_tab">
      <thead>
      <tr>
        <th>Reading Time</th>
        <th>Heart Rate</th>
      </tr>
      </thead>
      <tbody>
          <% @values_hr.each do |i| %>
          <tr>
            <% sec = (i[0].to_f / 1000) %>
            <% datetime = Time.at(sec) %>
            <th><%=datetime%></th>
            <th><%= i[1] %></th>
          </tr>
          <% end %>
      </tbody>
    </table>
    <table class="table" id="bloodoxygen_tab">
      <thead>
      <tr>
        <th>Reading Time</th>
        <th>Blood Oxygen %</th>
      </tr>
      </thead>
      <tbody>
        <% @values_bo.each do |i| %>
        <tr>
            <% sec = (i[0].to_f / 1000) %>
            <% datetime = Time.at(sec) %>
            <th><%=datetime%></th>
            <th><%= i[1] %></th>
        </tr>
      <% end %>
      </tbody>
    </table>
    <!--table class="table" id="activity_tab">
      <thead>
      <tr>
        <th>Reading Time</th>
        <th>Sodium</th>
      </tr>
      </thead>
      <tbody>

      </tbody>
    </table-->
    <table class="table" id="sodium_tab">
      <thead>
      <tr>
        <th>Reading Time</th>
        <th>Sodium</th>
      </tr>
      </thead>
      <tbody>
      <% @values_so.each do |i| %>
          <tr>
            <% sec = (i[0].to_f / 1000) %>
            <% datetime = Time.at(sec) %>
            <th><%=datetime%></th>
            <% if i[1] == 1 %>
                <th>Low</th>
            <% end %>
            <% if i[1] == 2 %>
                <th>Medium</th>
            <% end %>
            <% if i[1] == 3 %>
                <th>High</th>
            <% end %>
          </tr>
      <% end %>
      </tbody>
    </table>
  </div>
  <div class="col col-md-12" id="notes-container"></div>
</div>

<script>
    $(document).ready(function() {
        $('#navvertical').hide();
        // Click handler
        $('#slidehorizontal').click(function(){
            $('#navvertical').animate({width: 'toggle'});
            $('#patientpic-container').toggle();
            $('#patientinfo-container').toggle();
            $('#medication-container').toggle();
        });
    });
</script>
<script>
    function hideAll() {
      $('#weight_tab').hide();
      $('#bloodpressure_tab').hide();
      $('#heartrate_tab').hide();
      $('#bloodoxygen_tab').hide();
      $('#sodium_tab').hide();
      $('#activity_tab').hide();
      $('#timeperiod').hide();
    }

    function showGraph(metric) {
      hideAll();
      if(metric == "weight") {
        $('#timeperiod').show();
        $('#chart').html("<%= escape_javascript(render :partial => 'patient/weight', :locals => {:threshold => @threshold_wt, :values => @values_wt})%>");
          <%= values = @values_wt %>
          $('#weight_tab').reload();
          $('#weight_tab').show();
        $('#oneweek').click(function(){
            $('#chart').html("<%= escape_javascript(render :partial => 'patient/weight', :locals => {:threshold => @threshold_wt, :values => @values_wt})%>");
            <%= values = @values_wt %>
            $('#weight_tab').reload();
            $('#weight_tab').show();
        })
        $('#twoweeks').click(function(){
            $('#chart').html("<%= escape_javascript(render :partial => 'patient/weight', :locals => {:threshold => @threshold_wt2w, :values => @values_wt2w})%>");

            <%= values = @values_wt2w %>
            $('#weight_tab').reload();
            $('#weight_tab').show();
        })
          $('#onemonth').click(function(){
              $('#chart').html("<%= escape_javascript(render :partial => 'patient/weight', :locals => {:threshold => @threshold_wtm, :values => @values_wtm})%>");
              $('#weight_tab').show();
          })
          $('#threemonths').click(function(){
              $('#chart').html("<%= escape_javascript(render :partial => 'patient/weight', :locals => {:threshold => @threshold_wt3m, :values => @values_wt3m})%>");
              $('#weight_tab').show();
          })
          $('#sixmonths').click(function(){
              $('#chart').html("<%= escape_javascript(render :partial => 'patient/weight', :locals => {:threshold => @threshold_wt6m, :values => @values_wt6m})%>");
              $('#weight_tab').show();
          })
          $('#ayear').click(function(){
              $('#chart').html("<%= escape_javascript(render :partial => 'patient/weight', :locals => {:threshold => @threshold_wty, :values => @values_wty})%>");
              $('#weight_tab').show();
          })

      } else if(metric == "blood_pressure") {
        $('#chart').html("<%= escape_javascript(render :partial => 'patient/blood_pressure', :locals => {:threshold => @threshold_bp, :values => @values_bp})%>");
        $('#bloodpressure_tab').show();
      } else if(metric == "heart_rate_trend") {
        $('#chart').html("<%= escape_javascript(render :partial => 'patient/heart_rate_trend', :locals => {:threshold => @threshold_hr, :values => @values_hr})%>");
        $('#heartrate_tab').show();
          $('#timeperiod').show();

          $('#oneweek').click(function(){
              $('#chart').html("<%= escape_javascript(render :partial => 'patient/heart_rate_trend', :locals => {:threshold => @threshold_hr, :values => @values_hr})%>");
              $('#heartrate_tab').show();
          })
          $('#twoweeks').click(function(){
              $('#chart').html("<%= escape_javascript(render :partial => 'patient/heart_rate_trend', :locals => {:threshold => @threshold_hr2w, :values => @values_hr2w})%>");
              $('#heartrate_tab').show();
          })
          $('#onemonth').click(function(){
              $('#chart').html("<%= escape_javascript(render :partial => 'patient/heart_rate_trend', :locals => {:threshold => @threshold_hrm, :values => @values_hrm})%>");
              $('#heartrate_tab').show();
          })
          $('#threemonths').click(function(){
              $('#chart').html("<%= escape_javascript(render :partial => 'patient/heart_rate_trend', :locals => {:threshold => @threshold_hr3m, :values => @values_hr3m})%>");
              $('#heartrate_tab').show();
          })
          $('#sixmonths').click(function(){
              $('#chart').html("<%= escape_javascript(render :partial => 'patient/heart_rate_trend', :locals => {:threshold => @threshold_hr6m, :values => @values_hr6m})%>");
              $('#heartrate_tab').show();
          })
          $('#ayear').click(function(){
              $('#chart').html("<%= escape_javascript(render :partial => 'patient/heart_rate_trend', :locals => {:threshold => @threshold_hry, :values => @values_hry})%>");
              $('#heartrate_tab').show();
          })
      } else if(metric == "blood_oxygen") {
        $('#chart').html("<%= escape_javascript(render :partial => 'patient/blood_oxygen', :locals => {:threshold => @threshold_bo, :values => @values_bo})%>");
        $('#bloodoxygen_tab').show();
        $('#timeperiod').show();

          $('#oneweek').click(function(){
              $('#chart').html("<%= escape_javascript(render :partial => 'patient/blood_oxygen', :locals => {:threshold => @threshold_bo, :values => @values_bo})%>");
              $('#bloodoxygen_tab').show();
          })
          $('#twoweeks').click(function(){
              $('#chart').html("<%= escape_javascript(render :partial => 'patient/blood_oxygen', :locals => {:threshold => @threshold_bo2w, :values => @values_bo2w})%>");
              $('#bloodoxygen_tab').show();
          })
          $('#onemonth').click(function(){
              $('#chart').html("<%= escape_javascript(render :partial => 'patient/blood_oxygen', :locals => {:threshold => @threshold_bom, :values => @values_bom})%>");
              $('#bloodoxygen_tab').show();
          })
          $('#threemonths').click(function(){
              $('#chart').html("<%= escape_javascript(render :partial => 'patient/blood_oxygen', :locals => {:threshold => @threshold_bo3m, :values => @values_bo3m})%>");
              $('#bloodoxygen_tab').show();
          })
          $('#sixmonths').click(function(){
              $('#chart').html("<%= escape_javascript(render :partial => 'patient/blood_oxygen', :locals => {:threshold => @threshold_bo6m, :values => @values_bo6m})%>");
              $('#bloodoxygen_tab').show();
          })
          $('#ayear').click(function(){
              $('#chart').html("<%= escape_javascript(render :partial => 'patient/blood_oxygen', :locals => {:threshold => @threshold_boy, :values => @values_boy})%>");
              $('#bloodoxygen_tab').show();
          })
      } else if(metric == "sodium") {
         $('#chart').html("<%= escape_javascript(render :partial => 'patient/sodium', :locals => {:threshold => @threshold_so, :values => @values_so})%>");
         $('#sodium_tab').show();
         $('#timeperiod').show();

          $('#oneweek').click(function(){
              $('#chart').html("<%= escape_javascript(render :partial => 'patient/sodium', :locals => {:threshold => @threshold_so, :values => @values_so})%>");
              $('#sodium_tab').show();
          })
          $('#twoweeks').click(function(){
              $('#chart').html("<%= escape_javascript(render :partial => 'patient/sodium', :locals => {:threshold => @threshold_so2w, :values => @values_so2w})%>");
              $('#sodium_tab').show();
          })
          $('#onemonth').click(function(){
              $('#chart').html("<%= escape_javascript(render :partial => 'patient/sodium', :locals => {:threshold => @threshold_som, :values => @values_som})%>");
              $('#sodium_tab').show();
          })
          $('#threemonths').click(function(){
              $('#chart').html("<%= escape_javascript(render :partial => 'patient/sodium', :locals => {:threshold => @threshold_so3m, :values => @values_so3m})%>");
              $('#sodium_tab').show();
          })
          $('#sixmonths').click(function(){
              $('#chart').html("<%= escape_javascript(render :partial => 'patient/sodium', :locals => {:threshold => @threshold_so6m, :values => @values_so6m})%>");
              $('#sodium_tab').show();
          })
          $('#ayear').click(function(){
              $('#chart').html("<%= escape_javascript(render :partial => 'patient/sodium', :locals => {:threshold => @threshold_soy, :values => @values_soy})%>");
              $('#sodium_tab').show();
          })
      } else if(metric == "activity") {
         $('#chart').html("<%= escape_javascript(render :partial => 'patient/exercise_log', :locals => {:exercise_log => @exercise_log})%>");
          $('#activity_tab').show();
      } else { /* show weight by default */
        $('#chart').html("<%= escape_javascript(render :partial => 'patient/weight', :locals => {:threshold => @threshold_wt, :values => @values_wt})%>");
        $('#weight_tab').show();
        $('#timeperiod').show();
      }
    }

    function setupButtons() {
      $('#weight').click(function(){
          showGraph("weight");
      })
      $('#bloodpress').click(function(){
          showGraph("blood_pressure");
      })
      $('#heartratetrend').click(function(){
          showGraph("heart_rate_trend");
      })
      $('#bloodoxygen').click(function(){
          showGraph("blood_oxygen");
      })
      $('#activity').click(function(){
          showGraph("activity");
      })
      $('#sodium').click(function(){
          showGraph("sodium");
      })
    }

    setupButtons();
    showGraph("<%= @metric %>");

</script>